<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abra sua B√≠blia!</title>
    <link rel="shortcut icon" href="assets/icons/favicon.ico" type="image/x-icon">
    <link rel="icon" href="assets/icons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4a6da7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Abra sua B√≠blia">
    <meta name="description" content="Leia e pesquise a B√≠blia Sagrada de forma r√°pida e pr√°tica">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- Theme initialization script (prevents flash of wrong theme) -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'auto';
            let effectiveTheme = savedTheme;
            if (savedTheme === 'auto') {
                effectiveTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }
            if (effectiveTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V7M3H6L9Y6"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-V7M3H6L9Y6');
    </script>
</head>
<body>
    <div class="main-content">
        <div class="container">
            <div class="preloaded-bibles">
                <div class="bible-selection">
                    <h3 class="page-title">Abra sua B√≠blia &rArr;</h3>
                    <select id="bible-select">
                    </select>
                    <button id="theme-button" class="theme-button" title="Tema: Autom√°tico">
                        <span id="theme-icon">üåì</span>
                    </button>
                </div>
            </div>

            <div class="file-input-container">
                <input type="file" id="bible-file">
                <button id="download-ebf-button" class="action-button" title="Baixar arquivo EBF gerado" disabled>
                    <span class="download-icon">&#x23EC;</span>
                </button>
                <button id="file-help-button" class="action-button" title="Ajuda sobre upload">
                    <span class="help-icon">&#x2753;</span>
                </button>
            </div>

            <div class="expandable-section book-section">
                <h3 class="expandable-header">Livros<span class="expand-icon">‚ñº</span></h3>
                <div class="expandable-content">
                    <div id="book-list" class="book-list">
                        <!-- A lista de livros ser√° preenchida dinamicamente -->
                    </div>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="reference" placeholder="Ex: Mt 5,3-12.21-38">
                <button id="history-button" class="action-button" title="Hist√≥rico de buscas">
                    <span class="history-icon">&#x23F3;</span>
                </button>
                <button id="reference-help-button" class="action-button" title="Ajuda">
                    <span class="help-icon">&#x2753;</span>
                </button>
            </div>
            
            <div class="buttons-block" id="formatting-buttons">
                <button id="display-quotes" class="format-button" title="Aspas no texto">" "</button>
                <button id="display-verse-numbers" class="format-button" title="N√∫meros dos vers√≠culos">123</button>
                <button id="display-line-breaks" class="format-button" title="Quebra de linha ap√≥s cada vers√≠culo">&#8626;</button>
                <button id="display-ellipsis" class="format-button" title="S√≠mbolo de continua√ß√£o nos vers√≠culos quebrados">[...]</button>
                <button id="display-parentheses-citation" class="format-button" title="Cita√ß√£o ap√≥s o texto">()</button>
                <button id="display-section-titles" class="format-button" title="T√≠tulos das se√ß√µes">T</button>
            </div>

            <div class="buttons-block" id="static-action-buttons">
                <button id="prev-chapter-button" class="action-button" title="Cap√≠tulo anterior">&#9664;</button>
                <button id="copy-button" class="action-button" title="Copiar texto">&#128203;</button>
                <button id="share-button" class="action-button" title="Compartilhar">&#128279;</button>
                <button id="next-chapter-button" class="action-button" title="Pr√≥ximo cap√≠tulo">&#9654;</button>
            </div>

            <div class="result-container">
                <div class="result" id="result">
                    <span class="help-content">
                        Digite a refer√™ncia b√≠blica em um dos seguintes formatos:
                        <ul>
                            <li>
                                <strong>Livro cap√≠tulo</strong><br>
                                Mostra o cap√≠tulo completo<br>
                                (ex: <code>Mt 5</code> para mostrar Mateus cap√≠tulo 5 inteiro)
                            </li>
                            <li>
                                <strong>Livro cap√≠tulo,vers√≠culo</strong><br>
                                Mostra um vers√≠culo espec√≠fico<br>
                                (ex: <code>Mt 5,13</code> para Mateus cap√≠tulo 5, vers√≠culo 13)
                            </li>
                            <li>
                                <strong>Livro cap√≠tulo,vers√≠culo-</strong><br>
                                Mostra a partir de um vers√≠culo espec√≠fico<br>
                                (ex: <code>Mt 5,3-</code> para Mateus cap√≠tulo 5, vers√≠culos 3 em diante)
                            </li>
                            <li>
                                <strong>Livro cap√≠tulo,in√≠cio-fim</strong><br>
                                Mostra um intervalo de vers√≠culos<br>
                                (ex: <code>Mt 5,3-12</code> para Mateus cap√≠tulo 5, vers√≠culos 3 a 12)
                            </li>
                            <li>
                                <strong>Livro cap√≠tulo,vers√≠culos combinados</strong><br>
                                Use ponto para separar vers√≠culos ou intervalos n√£o consecutivos<br>
                                (ex: <code>Mt 5,3-12.21-38</code> para Mateus cap√≠tulo 5, vers√≠culos de 3 a 12, mais os vers√≠culos de 21 a 38)
                            </li>
                        </ul>
                    </span>
                </div>
                
                <!-- Bot√µes de navega√ß√£o flutuantes -->
                <div class="buttons-block" id="floating-action-buttons">
                    <button id="floating-prev-chapter-button" class="action-button" title="Cap√≠tulo anterior">&#9664;</button>
                    <button id="floating-copy-button" class="action-button" title="Copiar texto">&#128203;</button>
                    <button id="floating-share-button" class="action-button" title="Compartilhar">&#128279;</button>
                    <button id="floating-next-chapter-button" class="action-button" title="Pr√≥ximo cap√≠tulo">&#9654;</button>
                </div>
            </div>
            
            <div id="about-footer" class="expandable-section about-section">
                <h3 class="expandable-header">Sobre<span class="expand-icon">‚ñº</span></h3>
                <div class="expandable-content">
                <ul>
                    <li>
                        Desenvolvido por:<br>
                        <a href="https://github.com/natanael127" target="_blank" rel="noopener noreferrer">Natanael de Souza Figueiredo</a>
                    </li>
                    <li>
                        B√≠blias Ave-Maria e CNBB em formato TXT:<br>
                        <a href="https://yourmenial.blogspot.com/" target="_blank" rel="noopener noreferrer">Gustavo Monteiro Gon√ßalves</a>
                    </li>
                </ul>
                <p>
                    <a href="mailto:contato@abrasuabiblia.com.br" target="_blank" rel="noopener noreferrer">contato@abrasuabiblia.com.br</a>
                </p>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/page.js"></script>
    <script src="assets/js/bibleUtils.js"></script>
    <script src="assets/js/xmlBibles.js"></script>
    <script src="assets/js/bibleManager.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('Service Worker registrado com sucesso:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New content is available
                                    console.log('Nova vers√£o dispon√≠vel!');
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('Falha ao registrar Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
